#! /usr/bin/env python3
# send jvc ccu RM-P210 commands
import serial
import time

ser = serial.Serial('/dev/ttyUSB0', 9600, parity=serial.PARITY_EVEN)
ser.timeout=0.1

def waitCam():
    ack=False
    while(not ack):
        try:
            r = ord(ser.read())
            ack=True
        except TypeError:
            print("waiting for CAM...")
            ack=False
 
    if(r & 0x02):
        print("cam accept")
    else:
        print("cam reject")

def sendCmd(cmd):
    ser.write(b'\x83')
    waitCam()
    ser.write(cmd)
    waitCam()

def sendVal(cmd):
    ser.write(b'\x84')
    waitCam()
    ser.write(cmd)
    waitCam()

connected=False
while(not connected):
    ser.write(b'\x80')
    r=ser.read()
    if(r == b'\x80'):
        ser.write(b'\xA0')
        connected=True
        print("connected")
    else:
        print("waiting")
    time.sleep(0.8)
time.sleep(1)

sendCmd(b'\x41\x7D\x3E')
sendCmd(b'\x40\x00\x40')
sendCmd(b'\x41\x51\x12')
sendCmd(b'\x42\x03\x45')
sendCmd(b'\x40\x02\x42')
sendVal(b'\x00\x06\x08\x0E')
sendCmd(b'\x41\x02\x43')
sendVal(b'\x04\x06\x08\x12')
sendCmd(b'\x40\x02\x42')
sendCmd(b'\x61\x06\x67')
sendCmd(b'\x41\x03\x44')
sendCmd(b'\x40\x0C\x4C')
sendCmd(b'\x41\x0C\x4D')
sendCmd(b'\x42\x0C\x4E')
sendCmd(b'\x43\x0C\x4F')
sendCmd(b'\x44\x0C\x50')
sendCmd(b'\x45\x0C\x51')
sendCmd(b'\x46\x0C\x52')
sendCmd(b'\x4F\x0C\x5B')
sendVal(b'\x05\x62\x6E\x55')
sendCmd(b'\x40\x0C\x4C')
sendVal(b'\x00\x63\x14\x77')
sendCmd(b'\x60\x06\x66')
sendCmd(b'\x40\x03\x43')
sendCmd(b'\x41\x03\x44')
sendCmd(b'\x42\x03\x45')
sendCmd(b'\x43\x03\x46')
sendCmd(b'\x4F\x03\x52')
sendCmd(b'\x42\x03\x45')
sendVal(b'\x02\x63\x28\x0D')
sendVal(b'\x02\x72\x30\x24')
sendCmd(b'\x43\x03\x46')
sendVal(b'\x02\x64\x04\x6A')
sendVal(b'\x02\x74\x1C\x12')
sendCmd(b'\x40\x03\x43')
sendVal(b'\x00\x23\x3C\x5F')
sendVal(b'\x00\x33\x68\x1B')
sendCmd(b'\x41\x03\x44')
sendCmd(b'\x40\x07\x47')
sendCmd(b'\x41\x07\x48')
sendCmd(b'\x42\x07\x49')
sendCmd(b'\x43\x07\x4A')
sendCmd(b'\x44\x07\x4B')
sendCmd(b'\x45\x07\x4C')
sendCmd(b'\x46\x07\x4D')
sendCmd(b'\x48\x07\x4F')
sendCmd(b'\x4A\x07\x51')
sendCmd(b'\x4E\x07\x55')
sendVal(b'\x07\x48\x01\x50')
sendCmd(b'\x41\x51\x12')
sendCmd(b'\x40\x51\x11')
sendCmd(b'\x40\x07\x47')
sendCmd(b'\x41\x08\x49')
sendCmd(b'\x41\x53\x14')
sendCmd(b'\x40\x08\x48')
sendCmd(b'\x40\x53\x13')
sendCmd(b'\x41\x09\x4A')
sendCmd(b'\x40\x09\x49')
sendCmd(b'\x41\x0F\x50')
sendCmd(b'\x42\x0F\x51')
sendCmd(b'\x40\x0F\x4F')
sendCmd(b'\x40\x4B\x0B')
sendCmd(b'\x42\x4B\x0D')
sendCmd(b'\x4F\x4B\x1A')
sendCmd(b'\x41\x4B\x0C')
sendCmd(b'\x40\x4C\x0C')
sendCmd(b'\x42\x4C\x0E')
sendCmd(b'\x4F\x4C\x1B')
sendCmd(b'\x41\x4C\x0D')
sendCmd(b'\x41\x4F\x10')
sendCmd(b'\x42\x4F\x11')
sendCmd(b'\x40\x4F\x0F')
sendCmd(b'\x41\x1B\x5C')
sendCmd(b'\x40\x1B\x5B')
sendVal(b'\x01\x25\x30\x56')
sendCmd(b'\x40\x01\x41')
sendVal(b'\x01\x44\x00\x45')
sendVal(b'\x01\x64\x00\x65')
sendCmd(b'\x41\x4C\x0D')
sendCmd(b'\x40\x4D\x0D')
sendCmd(b'\x40\x1C\x5C')
sendVal(b'\x03\x26\x04\x2D')
sendCmd(b'\x41\x4E\x0F')
sendCmd(b'\x40\x1B\x5B')
sendCmd(b'\x40\x1D\x5D')
sendVal(b'\x03\x61\x14\x78')
sendCmd(b'\x40\x0F\x4F')
sendCmd(b'\x40\x4F\x0F')
sendCmd(b'\x40\x4A\x0A')
sendCmd(b'\x41\x4B\x0C')
sendCmd(b'\x40\x52\x12')
sendVal(b'\x0F\x3F\x7C\x4A')
sendVal(b'\x0F\x20\x08\x37')
sendVal(b'\x0F\x20\x0C\x3B')
sendVal(b'\x0F\x28\x0C\x43')
sendVal(b'\x0F\x30\x0C\x4B')
sendCmd(b'\x40\x07\x47')
sendCmd(b'\x40\x00\x40')
sendCmd(b'\x40\x50\x10')
ser.write(b'\x90')
waitCam()
sendCmd(b'\x40\x09\x49')
sendCmd(b'\x40\x07\x47')
sendCmd(b'\x40\x0C\x4C')
sendCmd(b'\x40\x53\x13')
sendCmd(b'\x40\x08\x48')
sendCmd(b'\x60\x0B\x6B')

time.sleep(1)

#sendCmd(b'\x41\x02\x43')
sendCmd(b'\x41\x00\x41')





#ser.write(b'\x80\x80\xA0\x83\x41\x7D\x3E\x83\x40\x00\x40\x83\x41\x51\x12\x83\x42\x03\x45\x83\x40\x02\x42\x84\x00\x06\x08\x0E\x83\x41\x02\x43\x84\x04\x06\x08\x12\x83\x40\x02\x42\x83\x61\x06\x67\x83\x41\x03\x44\x83\x40\x0C\x4C\x83\x41\x0C\x4D\x83\x42\x0C\x4E\x83\x43\x0C\x4F\x83\x44\x0C\x50\x83\x45\x0C\x51\x83\x46\x0C\x52\x83\x4F\x0C\x5B\x84\x05\x62\x6E\x55\x83\x40\x0C\x4C\x84\x00\x63\x14\x77\x83\x60\x06\x66\x83\x40\x03\x43\x83\x41\x03\x44\x83\x42\x03\x45\x83\x43\x03\x46\x83\x4F\x03\x52\x83\x42\x03\x45\x84\x02\x63\x28\x0D\x84\x02\x72\x30\x24\x83\x43\x03\x46\x84\x02\x64\x04\x6A\x84\x02\x74\x1C\x12\x83\x40\x03\x43\x84\x00\x23\x3C\x5F\x84\x00\x33\x68\x1B\x83\x41\x03\x44\x83\x40\x07\x47\x83\x41\x07\x48\x83\x42\x07\x49\x83\x43\x07\x4A\x83\x44\x07\x4B\x83\x45\x07\x4C\x83\x46\x07\x4D\x83\x48\x07\x4F\x83\x4A\x07\x51\x83\x4E\x07\x55\x84\x07\x48\x01\x50\x83\x41\x51\x12\x83\x40\x51\x11\x83\x40\x07\x47\x83\x41\x08\x49\x83\x41\x53\x14\x83\x40\x08\x48\x83\x40\x53\x13\x83\x41\x09\x4A\x83\x40\x09\x49\x83\x41\x0F\x50\x83\x42\x0F\x51\x83\x40\x0F\x4F\x83\x40\x4B\x0B\x83\x42\x4B\x0D\x83\x4F\x4B\x1A\x83\x41\x4B\x0C\x83\x40\x4C\x0C\x83\x42\x4C\x0E\x83\x4F\x4C\x1B\x83\x41\x4C\x0D\x83\x41\x4F\x10\x83\x42\x4F\x11\x83\x40\x4F\x0F\x83\x41\x1B\x5C\x83\x40\x1B\x5B\x84\x01\x25\x30\x56\x83\x40\x01\x41\x84\x01\x44\x00\x45\x84\x01\x64\x00\x65\x83\x41\x4C\x0D\x83\x40\x4D\x0D\x83\x40\x1C\x5C\x84\x03\x26\x04\x2D\x83\x41\x4E\x0F\x83\x40\x1B\x5B\x83\x40\x1D\x5D\x84\x03\x61\x14\x78\x83\x40\x0F\x4F\x83\x40\x4F\x0F\x83\x40\x4A\x0A\x83\x41\x4B\x0C\x83\x40\x52\x12\x84\x0F\x3F\x7C\x4A\x84\x0F\x20\x08\x37\x84\x0F\x20\x0C\x3B\x84\x0F\x28\x0C\x43\x84\x0F\x30\x0C\x4B\x83\x40\x07\x47\x83\x40\x00\x40\x83\x40\x50\x10\x90\x83\x40\x09\x49\xA0\xA0\x83\x40\x07\x47\xA0\xA0\x83\x40\x0C\x4C\x83\x40\x53\x13\x83\x40\x08\x48\x83\x60\x0B\x6B\x83\x41\x00\x41\x00')
